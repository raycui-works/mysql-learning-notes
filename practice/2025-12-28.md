昨天查询了2个问题：
- 演过电影的演员有多少人？
- 没演过电影的演员有多少人？

查询这2个问题，分别用了2条SQL，今天，只用一条SQL查询，这就涉及到3个新增知识点：
- 关键字：CASE WHEN
- 函数：SUM()

```sql
SELECT
    SUM(CASE WHEN film_count > 0 THEN 1 ELSE 0 END) AS actors_with_films,
    SUM(CASE WHEN film_count = 0 THEN 1 ELSE 0 END) AS actors_without_films
FROM
    (
    SELECT
        a.actor_id,
        COUNT(fa.film_id) AS film_count
    FROM actor a
    LEFT JOIN film_actor fa
        ON a.actor_id = fa.actor_id
    GROUP BY a.actor_id
    ) t;
```

<br><br/>
判断下边的SQL是否正确，如不正确，错在哪？
```sql
SELECT 
    a.actor_id,
    fa.film_id AS film_count
FROM actor a
LEFT JOIN film_actor fa 
    ON a.actor_id = fa.actor_id
GROUP BY a.actor_id;
```
> GROUP BY是分类，分类完成，在数据库里仅按a.actor_id显示一行，但是fa.film_id有多行啊，那这时候，数据库要返回哪一行？报错吧！
> 如果必须要返回一行fa.film_id，那你必须告诉数据库应该返回哪一行。

<br><br/>

其它写法：
```sql
-- 演过电影的演员有多少人？
SELECT COUNT(DISTINCT a.actor_id) AS cnt
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id;
```
>INNER JOIN:只保留两边都匹配到的行（如果actor表有actor_id，但film_actor表没有对应的actor_id，则不会显示）
>DISTINCT:如果film_actor表里，同一个actor_id有多行记录，则对其去重后，计算行数。
<br><br/>

```sql
-- 没演过电影的演员有多少人？
SELECT COUNT(*) AS cnt
FROM actor a
LEFT JOIN film_actor fa ON a.actor_id = fa.actor_id
WHERE fa.actor_id IS NULL;
```
>最关键的就是：WHERE fa.actor_id IS NULL;这句SQL只查询没演过电影的演员。
>然后COUNT(*)计算行数。
